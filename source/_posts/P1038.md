---
title: P1038 [NOIP2003 提高组] 神经网络
date: 2021-02-03 08:27:59
tags: [拓扑排序,luogu]
---

# [Link](https://www.luogu.com.cn/problem/P1038)

当点/边权值为负时就不再传递（坑

```cpp
#include<iostream>
#include<algorithm>
#include<queue>
using namespace std;
struct EDGE{
  int to, next, w;
}edge[1001];
int head[1001], cnt = 0;
void addedge(int from, int to, int w)
{
  edge[ ++cnt].  to = to;
  edge[cnt].  next = head[from];
  edge[cnt].  w = w;
  head[from] = cnt;
}

int visited[1001], in[1001], c[1001];
bool out[1001];
int main()
{
  int n, m;
  queue <int> q;
  cin >> n >> m;
  for(int i = 1;i <= n;i++)
    {
      int u;
      visited[i] = out[i] = 0;
      cin >> c[i] >> u;
      if(c[i] > 0)
	{
	  q.push(i);
	  visited[i] = 1;
	}
      else
	c[i] -= u;
    }
  for(int i = 1;i <= m;i++)
    {
      int from, to, w;
      cin >> from >> to >> w;
      addedge(from, to, w);
      out[from] = 1;
    }
  while(!q.empty())
    {
      int k = q.front();
      q.pop();
      if(c[k] <= 0) // can output
	continue;
      for(int i = head[k];i != 0;i = edge[i].  next)
	{
	  int to = edge[i].  to;
	  c[to] += edge[i].  w * c[k];
	  if(!visited[to])
	    {
	      q.push(to);
	      visited[to] = 1;
	    }
	}
    }
  bool yay = 0;
  for(int i = 1;i <= n;i++)
    {
      if(!out[i] && c[i] > 0) // out layer and excited
	{
	  cout << i << " " << c[i] << endl;
	  yay = 1;
	}
    }
  if(yay == 0)
    {
      cout << "NULL" << endl;
    }
  return 0;
}
```
